# BioValue-AI 配置文件
# 版本: 1.0.0

system:
  env: development  # development | staging | production
  service_name: biovalue-ai
  version: "1.0.0"
  max_concurrency: 50
  shutdown_timeout: 30s

temporal:
  address: "localhost:7233"
  namespace: "biovalue"
  task_queue: "biovalue-main"
  worker:
    max_concurrent_activities: 20
    max_concurrent_workflows: 10
    activity_poll_interval: 100ms
  retry:
    initial_interval: 5s
    backoff_coefficient: 2.0
    maximum_interval: 1m
    maximum_attempts: 5

storage:
  redis:
    address: "localhost:6379"
    password: "${REDIS_PASSWORD}"
    db: 0
    pool_size: 100
    min_idle_conns: 10
    dial_timeout: 5s
    read_timeout: 3s
    write_timeout: 3s
    
  vector_db:
    type: milvus
    address: "localhost:19530"
    collection: "biovalue_embeddings"
    dimension: 1536
    index_type: IVF_FLAT
    metric_type: IP

llm:
  provider: openai
  model: gpt-4-turbo
  api_key: "${OPENAI_API_KEY}"
  base_url: "https://api.openai.com/v1"
  timeout: 120s
  max_retries: 3
  rate_limit:
    requests_per_minute: 60
    tokens_per_minute: 100000
  fallback:
    enabled: true
    provider: deepseek
    model: deepseek-chat
    api_key: "${DEEPSEEK_API_KEY}"

mcp:
  discovery:
    type: static  # static | consul | k8s
  servers:
    - id: web-search
      type: stdio
      command: "npx"
      args: ["-y", "@anthropic/mcp-server-web-search"]
      env:
        BRAVE_API_KEY: "${BRAVE_API_KEY}"
        
    - id: pdf-parser
      type: grpc
      address: "localhost:50052"
      timeout: 60s
      
    - id: sandbox-fusion
      type: grpc
      address: "localhost:50053"
      timeout: 300s

observability:
  tracing:
    enabled: true
    exporter: otlp
    endpoint: "localhost:4317"
    sample_rate: 0.1
    
  metrics:
    enabled: true
    port: 9090
    path: /metrics
    
  logging:
    level: info  # debug | info | warn | error
    format: json
    output: stdout

security:
  tls:
    enabled: false
    cert_file: /etc/ssl/certs/server.crt
    key_file: /etc/ssl/certs/server.key
    ca_file: /etc/ssl/certs/ca.crt
    
  vault:
    enabled: false
    address: "https://vault:8200"
    auth_method: kubernetes
    mount_path: "biovalue"
    
  audit:
    enabled: true
    storage: local
    bucket: biovalue-audit-logs
    encryption: false

# Redis Key Schema
redis_schema:
  ttl:
    financials: 86400      # 24 hours
    pipeline_raw: 86400    # 24 hours
    pipeline_analysis: 43200  # 12 hours
    market_forecast: 21600    # 6 hours
    report_final: 604800      # 7 days

