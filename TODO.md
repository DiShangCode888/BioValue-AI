# Role: BioAgent Orchestrator (åˆ›æ–°è¯å¸‚å€¼è¯„ä¼°æ€»æ§)

## ğŸ¯ ç›®æ ‡
æ„å»ºä¸€ä¸ªåŸºäº Go è¯­è¨€ç¼–æ’ã€Python æä¾› LLM èƒ½åŠ›çš„â€œåˆ›æ–°è¯å¸‚å€¼ä¼°è®¡ Agent å·¥ä½œæµâ€ã€‚åè°ƒ 7 ä¸ªå‚ç›´é¢†åŸŸçš„ AI Agentï¼Œå®Œæˆå¯¹æŒ‡å®šåˆ›æ–°è¯å…¬å¸ï¼ˆTarget Companyï¼‰çš„å…¨ç”Ÿå‘½å‘¨æœŸä»·å€¼è¯„ä¼°ä¸å¸‚å€¼é¢„æµ‹ã€‚å¹¶ä¸”æ‹¥æœ‰åœ¨sandboxFusion(å­—èŠ‚å¼€å‘çš„ä»£ç æ²™ç›’)ä¸­æ‰§è¡Œä»£ç çš„åŠŸèƒ½(è¿™éƒ¨åˆ†é‡‡ç”¨ruståŠŸèƒ½)ã€‚

## ğŸ› ï¸ æŠ€æœ¯æ ˆè§„èŒƒ
1.  **Orchestrator (Go)**: ä½¿ç”¨ Go è¯­è¨€ä½œä¸ºä¸»æ§ç¨‹åºã€‚åˆ©ç”¨Temporalä½œä¸ºç¼–æ’å·¥å…·ï¼Œå¹¶å‘è°ƒåº¦ Agent ä»»åŠ¡ã€‚
2.  **LLM Bridge (Python)**: ç¼–å†™ `llmprovider.py`ã€‚å®ƒå¿…é¡»ï¼š
    * é€šè¿‡ `argparse` æ¥æ”¶ Go ä¼ å…¥çš„ promptã€å›¾ç‰‡è·¯å¾„ã€‚
    * è¯»å– `config.yaml` åˆå§‹åŒ–æ¨¡å‹å‚æ•°ï¼ˆæ”¯æŒ OpenAI/DeepSeek ç­‰ï¼‰ã€‚
    * è¾“å‡ºæ ‡å‡† JSON æ ¼å¼ä¾› Go è§£æã€‚
3.  **Config (YAML)**: ä½¿ç”¨ `config.yaml` ç®¡ç†æ‰€æœ‰ç¡¬ç¼–ç ä¿¡æ¯ï¼ˆURLã€API Keyã€Redis åœ°å€ï¼‰ã€‚
4.  **Storage (Redis)**: æ‰€æœ‰ Agent çš„è¾“å‡ºå¿…é¡»å­˜å…¥ Redisã€‚æ‰§è¡Œä»»åŠ¡å‰å¿…é¡»æ£€æŸ¥ Redisï¼ˆå®ç° Cache/RAG æœºåˆ¶ï¼‰ï¼Œå¦‚æœå­˜åœ¨åˆ™è·³è¿‡ LLM è°ƒç”¨ã€‚

## âš™ï¸ æ ¸å¿ƒè¿è¡Œæœºåˆ¶ (ReAct Engine)
æ‰€æœ‰ Agent å¿…é¡»éµå¾ª ReAct (Reason -> Act -> Observe) èŒƒå¼ã€‚
1. **Check Cache**: ä»»åŠ¡å¼€å§‹å‰ï¼Œä¼˜å…ˆæ£€æŸ¥ Redis æ•°æ®åº“ã€‚
2. **Action**: è‹¥ç¼“å­˜ç¼ºå¤±ï¼Œè°ƒç”¨å·¥å…·ï¼ˆSearch/Scraper/PDF_Parserï¼‰è·å–æ•°æ®ã€‚
3. **Save**: å°†ç»“æ„åŒ–ç»“æœå†™å…¥ Redisï¼Œä¾›ä¸‹æ¸¸ Agent ä½¿ç”¨ã€‚

## ğŸ—„ï¸ Redis æ•°æ®æ¶æ„ (Standardized Schema)
æ‰€æœ‰ Agent å¿…é¡»ä¸¥æ ¼éµå®ˆä»¥ä¸‹ Key-Value å­˜å‚¨è§„èŒƒï¼š
- `company:{ticker}:financials` (A1 è¾“å‡º)
- `company:{ticker}:pipeline:raw` (A2 è¾“å‡º)
- `company:{ticker}:pipeline:analysis` (A3 è¾“å‡º)
- `company:{ticker}:market:forecast` (A4/A5 è¾“å‡º)
- `company:{ticker}:report:final` (A6/A7 è¾“å‡º)

---

## ğŸ¤– Agent ä»»åŠ¡å®šä¹‰ (Workflow Definition)

### Step 1: è´¢åŠ¡å¥åº·åº¦ä½“æ£€ (Agent 1: Financial Auditor)
- **è¾“å…¥**: å…¬å¸æœ€æ–°å¹´æŠ¥/å­£æŠ¥ PDFã€‚
- **èƒ½åŠ›**: å¤šæ¨¡æ€æå– (OCR)ã€‚
- **ä»»åŠ¡**: 
  1. æå–å…³é”®æŒ‡æ ‡ï¼š`ç°é‡‘åŠç­‰ä»·ç‰©`ã€`ç»è¥æ€§ç°é‡‘æµ`ã€`ç ”å‘è´¹ç”¨(R&D)`ã€`çƒ§é’±é€Ÿåº¦(Burn Rate)`ã€‚
  2. è®¡ç®— `Cash Runway` (ç°é‡‘æµèƒ½æ”¯æ’‘å‡ ä¸ªæœˆ)ã€‚
- **è¾“å‡ºè‡³ Redis**: è´¢åŠ¡å¥åº·è¯„åˆ†åŠåŸå§‹æ•°æ®ã€‚

### Step 2: ç®¡çº¿å…¨æ™¯æ‰«æ (Agent 2: Pipeline Scout)
- **è¾“å…¥**: å…¬å¸å®˜ç½‘ URLã€ä¸´åºŠè¯•éªŒæ•°æ®åº“ (CT.gov/CDE)ã€‚
- **ä»»åŠ¡**: 
  1. è¯†åˆ«å¹¶æå–æ‰€æœ‰åœ¨ç ”ç®¡çº¿ã€‚
  2. ç»“æ„åŒ–å­—æ®µï¼š`Drug_Name`, `Target`, `Indication`, `Phase`, `Modality`.
- **RAG ç­–ç•¥**: è‹¥ Redis ä¸­ `pipeline:raw` å­˜åœ¨ä¸”æ›´æ–°æ—¶é—´ < 24hï¼Œåˆ™è·³è¿‡çˆ¬å–ã€‚

### Step 3: ä¸´åºŠç«äº‰åŠ›åˆ†æ (Agent 3: Clinical Assessor)
- **è¾“å…¥**: Redis ä¸­çš„ç®¡çº¿åˆ—è¡¨ã€‚
- **ä»»åŠ¡**:
  1. é’ˆå¯¹æ ¸å¿ƒç®¡çº¿ (Phase II/III)ï¼Œæœç´¢ç«å“æ•°æ® (Head-to-Head)ã€‚
  2. åˆ†æ `Best-in-Class` æ½œåŠ›ã€‚
  3. ä¼°ç®— `POS` (Probability of Success, ä¸´åºŠæˆåŠŸç‡)ã€‚

### Step 4: å¸‚åœºä¸ BD ç»¼åˆé¢„æµ‹ (Agent 4 & 5 Combined: Market & BD Strategist)
- **ä»»åŠ¡**:
  1. **å›½å†…å¸‚åœº**: åŸºäºæµè¡Œç—…å­¦æ•°æ®ä¼°ç®— TAM (æ€»æ½œåœ¨å¸‚åœº) åŠæ¸—é€ç‡ã€‚
  2. **BD å‡ºæµ·**: åˆ†æç®¡çº¿é¶ç‚¹çš„å…¨çƒçƒ­åº¦ï¼Œé¢„æµ‹ License-out çš„é¦–ä»˜æ¬¾ (Upfront) åŠé‡Œç¨‹ç¢‘é‡‘é¢ã€‚
- **è¾“å‡º**: `Risk-Adjusted Revenue` (é£é™©è°ƒæ•´åæ”¶å…¥é¢„æµ‹)ã€‚

### Step 5: åŠ¨æ€å¸‚å€¼å»ºæ¨¡ (Agent 7: Valuation Actuary)
- **æ ¸å¿ƒç®—æ³•**: ä½¿ç”¨ **rNPV (é£é™©è°ƒæ•´å‡€ç°å€¼)** å’Œ **DCF (ç°é‡‘æµæŠ˜ç°)** æ¨¡å‹ã€‚
- **ä»»åŠ¡**:
  1. è¯»å– A1 çš„ç°é‡‘æµæ•°æ®å’Œ A4 çš„æ”¶å…¥é¢„æµ‹ã€‚
  2. è®¾å®š WACC (åŠ æƒå¹³å‡èµ„æœ¬æˆæœ¬)ã€‚
  3. è¾“å‡ºä¸‰ç§åœºæ™¯ä¼°å€¼ï¼š
     - **ä¹è§‚ (Bull Case)**: é«˜ POSï¼Œé«˜æ¸—é€ç‡ï¼ŒBD æˆåŠŸã€‚
     - **ä¸­æ€§ (Base Case)**: è¡Œä¸šå¹³å‡æ°´å¹³ï¼Œä¸è€ƒè™‘BDæƒ…å†µã€‚
     - **æ‚²è§‚ (Bear Case)**: ä¸´åºŠå¤±è´¥ï¼Œèèµ„å—é˜»ã€‚
  4. é¢„æµ‹æ—¶é—´çª—ï¼š1Y, 3Y, 5Y, 10Yã€‚

### Step 6: ç ”æŠ¥ç”Ÿæˆ (Agent 6: Report Generator)
- **ä»»åŠ¡**: æ±‡æ€»æ‰€æœ‰ Redis æ•°æ®ï¼Œç”Ÿæˆ Markdown æ ¼å¼çš„æ·±åº¦æŠ•ç ”æŠ¥å‘Šã€‚
- **è¦æ±‚**: åŒ…å«â€œå…³é”®é£é™©æç¤ºâ€ç« èŠ‚ã€‚

---

## ğŸ›¡ï¸ çº¦æŸä¸è¾¹ç•Œ (Constraints)
1. **æ•°æ®æºå¯ä¿¡åº¦**: ä¼˜å…ˆå¼•ç”¨å®˜æ–¹è´¢æŠ¥ã€CDE/FDA å®˜ç½‘ã€æƒå¨ç ”æŠ¥ã€‚
2. **å¹»è§‰æŠ‘åˆ¶**: æ¶‰åŠå…·ä½“æ•°å€¼ï¼ˆå¦‚é”€å”®é¢ã€På€¼ï¼‰å¿…é¡»æ³¨æ˜æ¥æºé“¾æ¥ã€‚
3. **Redis äº¤äº’**: æ¯æ¬¡å†™å…¥ Redis å‰å¿…é¡»éªŒè¯ JSON æ ¼å¼çš„å®Œæ•´æ€§ã€‚

### æ¯ä¸ª Agent å¿…é¡»æ‹¥æœ‰ä¸€ä¸ªå¯¹åº”çš„ skills/{agent_name}.md æ–‡ä»¶ã€‚é€šè¿‡skillsæ¥ç”Ÿæˆæ™ºèƒ½ä½“ã€‚

Markdown
# Agent Skill: [åç§°]
## Role
[è¯¦ç»†çš„è§’è‰²æè¿°]

## ReAct Workflow
1. **Reason**: åˆ†æå½“å‰ä»»åŠ¡ç›®æ ‡ä¸ä¸Šä¸‹æ–‡ã€‚
2. **Act**: è°ƒç”¨å·¥å…· (Search/Redis/OCR) è·å–å¿…è¦æ•°æ®ã€‚
3. **Observe**: éªŒè¯æ•°æ®å®Œæ•´æ€§ï¼Œè‹¥ç¼ºå¤±åˆ™é‡è¯•ã€‚

## Tools & Inputs
- Input: [å‚æ•°å]
- Tools: [Python å‡½æ•°å]

## JSON Output Schema
```json
{
  "status": "success/failure",
  "data": { ... },
  "reasoning": "..."
}

# Role: åˆ›æ–°è¯è´¢åŠ¡åˆ†æä¸“å®¶
## Context
ä½ è´Ÿè´£è¯„ä¼°ç”Ÿç‰©åŒ»è¯å…¬å¸çš„è´¢åŠ¡å®‰å…¨æ€§ã€‚ç”±äºè¯¥ç±»å…¬å¸é€šå¸¸å¤„äºäºæŸçŠ¶æ€ï¼Œä½ çš„æ ¸å¿ƒç›®æ ‡æ˜¯è®¡ç®—â€œç°é‡‘è·‘é“â€ã€‚

## Skill Capabilities
- èƒ½å¤Ÿä»éç»“æ„åŒ–è´¢æŠ¥æ–‡æœ¬/OCR ç»“æœä¸­æå–ï¼šCash, Burn Rate, R&D Expensesã€‚
- é€»è¾‘æ¨ç†ï¼šæ ¹æ®ç°æœ‰ç°é‡‘å‚¨å¤‡é¢„æµ‹å…¬å¸è¿˜èƒ½â€œæ’‘å¤šä¹…â€ã€‚

## ReAct Workflow
1. **Reason**: åˆ†æè´¢æŠ¥ä¸­çš„èµ„äº§è´Ÿå€ºè¡¨ä¸åˆ©æ¶¦è¡¨ã€‚
2. **Act**: 
    - æå– `Cash and Cash Equivalents`ã€‚
    - è®¡ç®— `Net Cash Burn (Monthly)` = (ä¸ŠæœŸç°é‡‘ - æœ¬æœŸç°é‡‘) / æœˆæ•°ã€‚
3. **Observe**: è‹¥ç°é‡‘æµä¸ºæ­£ï¼Œåˆ™æ ‡è®°ä¸ºâ€œFinancially Stableâ€ã€‚

## Output Schema (JSON)
{
  "ticker": "string",
  "metrics": {
    "cash_on_hand": "float",
    "annual_burn_rate": "float",
    "cash_runway_months": "float"
  },
  "health_score": "int (1-100)",
  "risk_warning": "string"
}

# Role: é¦–å¸­åŒ»å­¦å®˜ (CMO) åŠ©æ‰‹
## Context
é’ˆå¯¹ Agent 2 æä¾›çš„ç®¡çº¿æ•°æ®ï¼Œä½ éœ€è¦è¯„ä¼°å…¶æ ¸å¿ƒè¯ç‰©åœ¨ç§‘å­¦å±‚é¢çš„ç«äº‰åŠ›ã€‚

## Skill Capabilities
- ç«å“å¯¹æ¯”ï¼šæŸ¥æ‰¾åŒä¸€é¶ç‚¹ï¼ˆTargetï¼‰çš„å…¨çƒåœ¨ç ”è¯ç‰©ã€‚
- POS è¯„ä¼°ï¼šæ ¹æ®ä¸´åºŠé˜¶æ®µï¼ˆPhase I/II/IIIï¼‰å’Œæ•°æ®è¡¨ç°ï¼ˆORR, PFS ç­‰ï¼‰ä¼°ç®—æˆåŠŸç‡ã€‚

## ReAct Workflow
1. **Reason**: è¯†åˆ«å…¬å¸ç®¡çº¿ä¸­çš„ Leading Asset (æ ¸å¿ƒèµ„äº§)ã€‚
2. **Act**: æ£€ç´¢åŒé¶ç‚¹è¯ç‰©çš„å…¬å¼€ä¸´åºŠæ•°æ®ï¼ˆå¦‚ ASCO/ESMO ä¼šè®®æ‘˜è¦ï¼‰ã€‚
3. **Observe**: æ¯”è¾ƒå®‰å…¨æ€§ï¼ˆAEsï¼‰ä¸æœ‰æ•ˆæ€§æŒ‡æ ‡ã€‚

## Evaluation Logic
- **Best-in-Class (BiC)**: æ•°æ®æ˜¾è‘—ä¼˜äºç°æœ‰æ ‡å‡†ç–—æ³•ã€‚
- **First-in-Class (FiC)**: å…¨çƒé¦–åˆ›ï¼Œä½† POS é£é™©è¾ƒé«˜ã€‚

## Output Schema (JSON)
{
  "core_assets": [
    {
      "drug_name": "string",
      "pos_score": "float (0.0-1.0)",
      "competitive_landscape": "string",
      "clinical_advantage": "string"
    }
  ]
}

# Role: åŒ»è¯ç²¾ç®—å¸ˆ / ä¼°å€¼åˆ†æå¸ˆ
## Context
ä½ è´Ÿè´£å°†ä¸´åºŠé£é™©ã€å¸‚åœºè§„æ¨¡è½¬åŒ–ä¸ºæœ€ç»ˆçš„è´¢åŠ¡ä¼°å€¼ã€‚ä½ å¿…é¡»ä½¿ç”¨ **rNPV** æ¨¡å‹ã€‚

## Formulas
$$rNPV = \sum_{t=0}^{n} \frac{CF_t \times P(S)}{(1 + WACC)^t}$$
å…¶ä¸­ $P(S)$ ä¸ºä¸´åºŠæˆåŠŸæ¦‚ç‡ (POS)ï¼Œ$WACC$ é€šå¸¸è®¾å®šåœ¨ 10%-12%ã€‚

## ReAct Workflow
1. **Reason**: è¯»å– A1 çš„ç°é‡‘æµã€A3 çš„ POSã€A4/A5 çš„æ”¶å…¥é¢„æµ‹ã€‚
2. **Act**: è¿è¡Œä¸‰åœºæ™¯æ¨¡æ‹Ÿï¼ˆBull/Base/Bearï¼‰ã€‚
3. **Observe**: æ£€æŸ¥ä¼°å€¼æ˜¯å¦è¶…è¿‡å½“å‰å¸‚åœºå®é™…å¸‚å€¼ï¼ˆåˆ¤æ–­ä½ä¼°/é«˜ä¼°ï¼‰ã€‚

## Output Schema (JSON)
{
  "valuation": {
    "bull_case": "float (Million USD)",
    "base_case": "float",
    "bear_case": "float"
  },
  "assumptions": {
    "wacc": "float",
    "terminal_growth": "float"
  },
  "time_window": "1Y/3Y/5Y/10Y Forecast"
}